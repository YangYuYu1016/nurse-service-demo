<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>护士上门服务流程 - 优化版</title>
    <style>
      body {
        font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 20px;
      }
      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        max-width: 1200px;
        margin: 0 auto;
      }
      .screen-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 30px; /* 从20px增加到50px */
      }
      .screen {
        width: 320px;
        height: 600px;
        background-color: white;
        border-radius: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        position: relative;
        margin-bottom: 20px;
      }
      .header {
        height: 50px;
        background-color: #4d7cfe;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        font-weight: bold;
        position: relative;
      }
      .back {
        position: absolute;
        left: 15px;
        top: 15px;
        cursor: pointer;
      }
      .content {
        padding: 15px;
        height: calc(100% - 80px);
        overflow-y: auto;
      }
      .card {
        background-color: #f9f9f9;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      }
      .btn {
        display: block;
        width: 100%;
        padding: 12px 0;
        background-color: #4d7cfe;
        color: white;
        text-align: center;
        border-radius: 8px;
        margin-top: 15px;
        font-weight: bold;
        border: none;
        cursor: pointer;
      }
      .btn.secondary {
        background-color: #f0f0f0;
        color: #333;
      }
      .btn.success {
        background-color: #4caf50;
      }
      .btn.danger {
        background-color: #ff5252;
      }
      .btn.warning {
        background-color: #ffc107;
        color: #333;
      }
      .footer {
        height: 30px;
        position: absolute;
        bottom: 0;
        width: 100%;
        background-color: #f8f8f8;
        display: flex;
        justify-content: space-around;
        align-items: center;
        border-top: 1px solid #eaeaea;
      }
      .item-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #eee;
      }
      .circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #ff5252;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        right: 20px;
        top: 80px;
        font-weight: bold;
      }
      .tag {
        display: inline-block;
        padding: 2px 8px;
        background-color: #e6f7ff;
        color: #1890ff;
        border-radius: 4px;
        margin-right: 5px;
        font-size: 12px;
      }
      .tag.urgent {
        background-color: #fff1f0;
        color: #ff4d4f;
      }
      .avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: #ddd;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 10px;
      }
      .flex {
        display: flex;
        align-items: center;
      }
      .map {
        width: 100%;
        height: 200px;
        background-color: #e1e1e1;
        margin: 10px 0;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #999;
        border-radius: 8px;
      }
      .checkbox {
        margin-right: 10px;
      }
      h3 {
        margin-top: 0;
      }
      .screen-title {
        text-align: center;
        font-weight: bold;
        margin-bottom: 5px;
        margin-top: 10px; /* 新增上边距 */
        color: #333;
      }
      .navigation {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        margin-bottom: 20px;
        gap: 10px;
      }
      .nav-btn {
        padding: 8px 15px;
        background-color: #4d7cfe;
        color: white;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
      }
      .nav-btn.active {
        background-color: #1d4ed8;
      }
      /* 隐藏所有画面，只显示当前活动的 */
      .screen-wrapper {
        display: none;
      }
      .screen-wrapper.active {
        display: block;
      }
      .process-flow {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px; /* 从20px增加到40px */
        margin-top: 20px; /* 从20px增加到30px */
        width: 100%;
        max-width: 800px;
        position: relative;
        padding: 0 10px;
      }
      .process-step {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background-color: #ddd;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2;
        position: relative;
        cursor: pointer;
      }
      .process-step.active {
        background-color: #4caf50;
        color: white;
      }
      .process-step.completed {
        background-color: #4d7cfe;
        color: white;
      }
      .process-line {
        position: absolute;
        height: 2px;
        background-color: #ddd;
        top: 15px;
        left: 40px;
        right: 40px;
        z-index: 1;
      }
      .process-line-progress {
        position: absolute;
        height: 2px;
        background-color: #4d7cfe;
        top: 15px;
        left: 40px;
        width: 0;
        z-index: 1;
        transition: width 0.3s;
      }
      .step-label {
        position: absolute;
        top: 35px;
        font-size: 12px;
        white-space: nowrap;
        transform: translateX(-50%);
        left: 50%;
      }
      .filter-bar {
        display: flex;
        gap: 5px;
        padding: 5px 0;
        overflow-x: auto;
        margin-bottom: 10px;
      }
      .filter-btn {
        padding: 5px 10px;
        background-color: #f0f0f0;
        border-radius: 15px;
        font-size: 12px;
        white-space: nowrap;
        border: none;
        cursor: pointer;
      }
      .filter-btn.active {
        background-color: #4d7cfe;
        color: white;
      }
      .distance {
        font-size: 12px;
        color: #1890ff;
        margin-left: 5px;
      }
      .time-estimation {
        font-size: 12px;
        color: #666;
      }
      .popup {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        z-index: 100;
        width: 250px;
        display: none;
      }
      .popup.active {
        display: block;
      }
      .overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 99;
        display: none;
      }
      .overlay.active {
        display: block;
      }
      .chip {
        display: inline-block;
        padding: 3px 10px;
        border-radius: 20px;
        font-size: 12px;
        margin-right: 5px;
        margin-bottom: 5px;
        cursor: pointer;
      }
      .chip.primary {
        background-color: #e6f7ff;
        color: #1890ff;
      }
      .chip.success {
        background-color: #f6ffed;
        color: #52c41a;
      }
      .box-shadow {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .rating {
        display: flex;
        gap: 5px;
        margin: 10px 0;
      }
      .star {
        font-size: 24px;
        color: #ddd;
        cursor: pointer;
      }
      .star.active {
        color: #ffca28;
      }
      .sop-step {
        background-color: #f0f8ff;
        padding: 10px;
        border-left: 3px solid #4d7cfe;
        margin-bottom: 10px;
        font-size: 14px;
      }
      .badge {
        display: inline-block;
        padding: 2px 8px;
        background-color: #ff5252;
        color: white;
        border-radius: 10px;
        font-size: 12px;
        position: absolute;
        right: 5px;
      }
      .rounded-input {
        border: 1px solid #ddd;
        border-radius: 20px;
        padding: 8px 15px;
        width: 100%;
        box-sizing: border-box;
        margin-bottom: 10px;
      }
      /* 表格样式 */
      .table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 15px;
      }
      .table th,
      .table td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #eee;
      }
      .table th {
        font-weight: bold;
        background-color: #f9f9f9;
      }
      h1 {
        font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
        margin-bottom: 30px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>护士上门服务流程演示</h1>

      <div class="process-flow">
        <div class="process-line"></div>
        <div class="process-line-progress" id="progressLine"></div>

        <div class="process-step active" onclick="showScreen(0)" id="step1">
          1
          <span class="step-label">护士听单</span>
        </div>
        <div class="process-step" onclick="showScreen(1)" id="step2">
          2
          <span class="step-label">接单</span>
        </div>
        <div class="process-step" onclick="showScreen(2)" id="step3">
          3
          <span class="step-label">待上门</span>
        </div>
        <div class="process-step" onclick="showScreen(3)" id="step4">
          4
          <span class="step-label">服务评估</span>
        </div>
        <div class="process-step" onclick="showScreen(4)" id="step5">
          5
          <span class="step-label">确认订单</span>
        </div>
        <div class="process-step" onclick="showScreen(5)" id="step6">
          6
          <span class="step-label">服务记录</span>
        </div>
        <div class="process-step" onclick="showScreen(6)" id="step7">
          7
          <span class="step-label">确认服务</span>
        </div>
        <div class="process-step" onclick="showScreen(7)" id="step8">
          8
          <span class="step-label">发起收款</span>
        </div>
      </div>

      <div class="screen-container">
        <!-- 界面1: 护士听单 (优化版) -->
        <div class="screen-wrapper active" id="screen1">
          <div class="screen-title">界面1: 护士听单</div>
          <div class="screen">
            <div class="header">
              <span>新订单通知</span>
              <span class="badge">2</span>
            </div>
            <div class="content">
              <!-- 新增: 筛选条件 -->
              <div class="filter-bar">
                <button class="filter-btn active">全部</button>
                <button class="filter-btn">附近优先</button>
                <button class="filter-btn">价格优先</button>
                <button class="filter-btn">紧急订单</button>
                <button class="filter-btn">输液/换药</button>
              </div>

              <div class="card" id="order1" onclick="selectOrder(this)">
                <div class="item-row">
                  <span>订单类型</span>
                  <span>
                    <span class="tag urgent">紧急</span>
                    <span class="tag">上门护理</span>
                  </span>
                </div>
                <div class="item-row">
                  <span>患者姓名</span>
                  <span>张女士</span>
                </div>
                <div class="item-row">
                  <span>服务地址</span>
                  <span
                    >海淀区xxxx小区 <span class="distance">3.2km</span></span
                  >
                </div>
                <div class="item-row">
                  <span>预约时间</span>
                  <span>今天 14:30</span>
                </div>
                <div class="item-row">
                  <span>服务内容</span>
                  <span>静脉输液</span>
                </div>
                <div class="item-row">
                  <span>预计服务费</span>
                  <span>¥120</span>
                </div>
                <div class="item-row">
                  <span>预计服务时长</span>
                  <span>45分钟</span>
                </div>
              </div>

              <div class="card">
                <div class="item-row">
                  <span>订单类型</span>
                  <span><span class="tag">上门换药</span></span>
                </div>
                <div class="item-row">
                  <span>患者姓名</span>
                  <span>李先生</span>
                </div>
                <div class="item-row">
                  <span>服务地址</span>
                  <span
                    >朝阳区xxxx小区 <span class="distance">5.8km</span></span
                  >
                </div>
                <div class="item-row">
                  <span>预约时间</span>
                  <span>今天 16:00</span>
                </div>
                <div class="item-row">
                  <span>预计服务时长</span>
                  <span>30分钟</span>
                </div>
              </div>

              <!-- 新增: 接单偏好设置入口 -->
              <button
                class="btn secondary"
                onclick="showPopup('preference-popup')"
              >
                设置接单偏好
              </button>
            </div>
            <div class="footer">
              <span>首页</span>
              <span>订单</span>
              <span>我的</span>
            </div>

            <!-- 新增: 偏好设置弹窗 -->
            <div class="overlay" id="preference-overlay"></div>
            <div class="popup" id="preference-popup">
              <h3>接单偏好设置</h3>
              <div class="item-row">
                <span>最大接单距离</span>
                <select>
                  <option>3公里</option>
                  <option selected>5公里</option>
                  <option>10公里</option>
                  <option>不限制</option>
                </select>
              </div>
              <div class="item-row">
                <span>可接服务类型</span>
                <div>
                  <div><input type="checkbox" checked /> 输液</div>
                  <div><input type="checkbox" checked /> 换药</div>
                  <div><input type="checkbox" checked /> 注射</div>
                  <div><input type="checkbox" /> 采血</div>
                </div>
              </div>
              <div class="item-row">
                <span>可接时段</span>
                <div>
                  <div><input type="checkbox" checked /> 上午(8:00-12:00)</div>
                  <div><input type="checkbox" checked /> 下午(12:00-18:00)</div>
                  <div><input type="checkbox" /> 晚上(18:00-22:00)</div>
                </div>
              </div>
              <button
                class="btn success"
                onclick="hidePopup('preference-popup')"
              >
                保存设置
              </button>
              <button
                class="btn secondary"
                onclick="hidePopup('preference-popup')"
              >
                取消
              </button>
            </div>
          </div>
        </div>

        <!-- 界面2: 接单 (优化版) -->
        <div class="screen-wrapper" id="screen2">
          <div class="screen-title">界面2: 接单</div>
          <div class="screen">
            <div class="header">
              <div class="back" onclick="showScreen(0)">←</div>
              <span>订单详情</span>
            </div>
            <div class="content">
              <div class="card">
                <div class="flex">
                  <div class="avatar">头像</div>
                  <div>
                    <div>张女士 | 35岁</div>
                    <div>电话: 138****6789</div>
                  </div>
                </div>
                <!-- 新增: 患者历史服务记录入口 -->
                <button
                  class="btn secondary"
                  style="margin-top: 10px"
                  onclick="showPopup('history-popup')"
                >
                  查看患者历史记录
                </button>
              </div>

              <div class="card">
                <h3>服务信息</h3>
                <div class="item-row">
                  <span>服务类型</span>
                  <span>静脉输液</span>
                </div>
                <div class="item-row">
                  <span>服务地址</span>
                  <span>海淀区xxxx小区2号楼1单元302</span>
                </div>
                <div class="item-row">
                  <span>预约时间</span>
                  <span>2023-11-15 14:30</span>
                </div>
                <div class="item-row">
                  <span>预计服务时长</span>
                  <span>45分钟</span>
                </div>
              </div>

              <div class="card">
                <h3>患者需求</h3>
                <p>感冒发烧，需要抗生素输液治疗，已有医生处方。</p>
                <!-- 新增: 查看处方入口 -->
                <button
                  class="btn secondary"
                  onclick="showPopup('prescription-popup')"
                >
                  查看处方
                </button>
              </div>

              <!-- 新增: 风险提示 -->
              <div
                class="card"
                style="
                  background-color: #fff1f0;
                  border-left: 3px solid #ff4d4f;
                "
              >
                <h3>特别注意</h3>
                <p>患者有青霉素过敏史，请确认用药安全。</p>
              </div>

              <div class="card">
                <h3>费用明细</h3>
                <div class="item-row">
                  <span>基础上门费</span>
                  <span>¥50</span>
                </div>
                <div class="item-row">
                  <span>输液操作费</span>
                  <span>¥70</span>
                </div>
                <div class="item-row">
                  <span>总计</span>
                  <span>¥120</span>
                </div>
              </div>

              <button class="btn success" onclick="showScreen(2)">
                接受订单
              </button>
              <button class="btn secondary" onclick="showPopup('reject-popup')">
                拒绝订单
              </button>
            </div>

            <!-- 新增: 处方查看弹窗 -->
            <div class="overlay" id="prescription-overlay"></div>
            <div class="popup" id="prescription-popup">
              <h3>处方详情</h3>
              <div class="item-row">
                <span>开方医院</span>
                <span>xx医院</span>
              </div>
              <div class="item-row">
                <span>开方医生</span>
                <span>王医生</span>
              </div>
              <div class="item-row">
                <span>诊断</span>
                <span>上呼吸道感染</span>
              </div>
              <div>
                <h4>药品</h4>
                <div class="item-row">
                  <span>头孢曲松</span>
                  <span>1g</span>
                </div>
                <div class="item-row">
                  <span>0.9%氯化钠</span>
                  <span>100ml</span>
                </div>
              </div>
              <img
                src="data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' width='200' height='150' viewBox='0 0 200 150'%3e%3crect width='200' height='150' fill='%23CCCCCC'/%3e%3ctext x='100' y='75' font-family='Arial' font-size='12' text-anchor='middle' fill='%23333333'%3e处方图片%3c/text%3e%3c/svg%3e"
                style="width: 100%; margin-top: 10px"
              />
              <button class="btn" onclick="hidePopup('prescription-popup')">
                关闭
              </button>
            </div>

            <!-- 新增: 患者历史记录弹窗 -->
            <div class="overlay" id="history-overlay"></div>
            <div class="popup" id="history-popup">
              <h3>患者历史服务记录</h3>
              <div class="item-row">
                <span>2023-10-25</span>
                <span>输液服务</span>
              </div>
              <div class="item-row">
                <span>2023-09-18</span>
                <span>换药服务</span>
              </div>
              <div class="item-row">
                <span>2023-08-05</span>
                <span>输液服务</span>
              </div>
              <div class="item-row">
                <span>患者评价</span>
                <span>⭐⭐⭐⭐⭐</span>
              </div>
              <button class="btn" onclick="hidePopup('history-popup')">
                关闭
              </button>
            </div>

            <!-- 新增: 拒单理由弹窗 -->
            <div class="overlay" id="reject-overlay"></div>
            <div class="popup" id="reject-popup">
              <h3>拒单理由</h3>
              <div>
                <div><input type="radio" name="reason" /> 距离太远</div>
                <div><input type="radio" name="reason" /> 服务时间冲突</div>
                <div><input type="radio" name="reason" /> 服务能力不匹配</div>
                <div><input type="radio" name="reason" /> 订单信息不明确</div>
                <div><input type="radio" name="reason" /> 其他原因</div>
                <textarea
                  placeholder="请输入详细原因..."
                  style="
                    width: 100%;
                    margin-top: 10px;
                    padding: 8px;
                    border-radius: 4px;
                    border: 1px solid #ddd;
                  "
                ></textarea>
              </div>
              <button class="btn danger" onclick="hidePopup('reject-popup')">
                确认拒绝
              </button>
              <button class="btn secondary" onclick="hidePopup('reject-popup')">
                取消
              </button>
            </div>
          </div>
        </div>

        <!-- 界面3: 待上门途中 (优化版) -->
        <div class="screen-wrapper" id="screen3">
          <div class="screen-title">界面3: 待上门途中</div>
          <div class="screen">
            <div class="header">
              <div class="back" onclick="showScreen(1)">←</div>
              <span>导航</span>
            </div>
            <div class="content">
              <div
                class="card"
                style="
                  margin-bottom: 5px;
                  display: flex;
                  justify-content: space-between;
                "
              >
                <div>
                  <div>张女士</div>
                  <div style="font-size: 12px; color: #666">服务：静脉输液</div>
                </div>
                <button
                  class="btn"
                  style="margin: 0; padding: 5px 10px; width: auto"
                  onclick="showPopup('call-popup')"
                >
                  联系患者
                </button>
              </div>

              <div class="map">
                地图导航区域
                <div style="position: absolute">
                  <div
                    style="
                      border: 2px solid #4d7cfe;
                      border-radius: 50%;
                      width: 10px;
                      height: 10px;
                      background: white;
                    "
                  ></div>
                  <div
                    style="
                      position: absolute;
                      left: 50px;
                      top: -10px;
                      border: 2px solid #ff5252;
                      border-radius: 50%;
                      width: 10px;
                      height: 10px;
                      background: white;
                    "
                  ></div>
                  <div
                    style="
                      position: absolute;
                      border-top: 2px dashed #4d7cfe;
                      width: 50px;
                      top: 5px;
                    "
                  ></div>
                </div>
              </div>

              <div class="card">
                <div
                  style="
                    text-align: center;
                    font-size: 20px;
                    font-weight: bold;
                    color: #4d7cfe;
                  "
                >
                  14分钟
                </div>
                <div style="text-align: center; margin-bottom: 10px">
                  预计到达时间
                </div>
                <div class="item-row">
                  <span>目的地</span>
                  <span>海淀区xxxx小区2号楼1单元302</span>
                </div>
                <div class="item-row">
                  <span>路线</span>
                  <span>最优路线 (2.3公里)</span>
                </div>
                <!-- 新增: 交通方式选择 -->
                <div class="item-row">
                  <span>交通方式</span>
                  <div>
                    <label style="margin-right: 10px"
                      ><input type="radio" name="transport" checked />
                      步行</label
                    >
                    <label style="margin-right: 10px"
                      ><input type="radio" name="transport" /> 驾车</label
                    >
                    <label><input type="radio" name="transport" /> 公交</label>
                  </div>
                </div>
              </div>

              <!-- 新增: 分享位置和延迟功能 -->
              <div class="card">
                <h3>服务状态</h3>
                <button
                  class="btn secondary"
                  style="margin-top: 5px"
                  onclick="showToast('已向患者分享您的位置')"
                >
                  向患者分享位置
                </button>
                <button
                  class="btn warning"
                  style="margin-top: 10px"
                  onclick="showPopup('delay-popup')"
                >
                  服务可能延迟
                </button>
              </div>

              <button class="btn success" onclick="showScreen(3)">
                已到达
              </button>
              <button
                class="btn secondary"
                onclick="showPopup('navigation-popup')"
              >
                使用第三方导航
              </button>
            </div>

            <!-- 新增: 导航应用选择弹窗 -->
            <div class="overlay" id="navigation-overlay"></div>
            <div class="popup" id="navigation-popup">
              <h3>选择导航应用</h3>
              <div class="item-row">
                <span><input type="radio" name="nav" checked /> 百度地图</span>
              </div>
              <div class="item-row">
                <span><input type="radio" name="nav" /> 高德地图</span>
              </div>
              <div class="item-row">
                <span><input type="radio" name="nav" /> 腾讯地图</span>
              </div>
              <button class="btn" onclick="hidePopup('navigation-popup')">
                打开导航
              </button>
              <button
                class="btn secondary"
                onclick="hidePopup('navigation-popup')"
              >
                取消
              </button>
            </div>

            <!-- 新增: 延迟服务弹窗 -->
            <div class="overlay" id="delay-overlay"></div>
            <div class="popup" id="delay-popup">
              <h3>服务延迟通知</h3>
              <div>预计延迟时间：</div>
              <select
                style="
                  width: 100%;
                  padding: 8px;
                  margin: 10px 0;
                  border-radius: 4px;
                  border: 1px solid #ddd;
                "
              >
                <option>延迟10分钟</option>
                <option>延迟20分钟</option>
                <option>延迟30分钟</option>
                <option>延迟超过30分钟</option>
              </select>
              <div>延迟原因：</div>
              <select
                style="
                  width: 100%;
                  padding: 8px;
                  margin: 10px 0;
                  border-radius: 4px;
                  border: 1px solid #ddd;
                "
              >
                <option>交通拥堵</option>
                <option>前一单服务延时</option>
                <option>临时紧急情况</option>
                <option>其他原因</option>
              </select>
              <textarea
                placeholder="补充说明..."
                style="
                  width: 100%;
                  padding: 8px;
                  border-radius: 4px;
                  border: 1px solid #ddd;
                "
              ></textarea>
              <button
                class="btn warning"
                onclick="hidePopup('delay-popup'); showToast('已通知患者服务延迟')"
              >
                通知患者
              </button>
              <button class="btn secondary" onclick="hidePopup('delay-popup')">
                取消
              </button>
            </div>
          </div>
        </div>

        <!-- 界面4: 服务评估 (优化版) -->
        <div class="screen-wrapper" id="screen4">
          <div class="screen-title">界面4: 服务评估</div>
          <div class="screen">
            <div class="header">
              <div class="back" onclick="showScreen(2)">←</div>
              <span>患者评估</span>
            </div>
            <div class="content">
              <div class="card">
                <h3>患者身份核对</h3>
                <div class="item-row">
                  <span>姓名</span>
                  <span>张女士</span>
                </div>
                <div class="item-row">
                  <span>性别</span>
                  <span>女</span>
                </div>
                <div class="item-row">
                  <span>年龄</span>
                  <span>35岁</span>
                </div>
                <div class="item-row">
                  <span>身份证</span>
                  <div>
                    <input
                      type="text"
                      placeholder="请核对身份证号"
                      style="width: 150px; padding: 5px"
                    />
                    <button
                      style="
                        padding: 5px;
                        background: #4d7cfe;
                        color: white;
                        border: none;
                        border-radius: 4px;
                      "
                    >
                      扫描
                    </button>
                  </div>
                </div>
                <div style="margin-top: 10px">
                  <input type="checkbox" id="identity-confirm" />
                  <label for="identity-confirm">已核对患者身份</label>
                </div>
              </div>

              <div class="card">
                <h3>健康状况评估</h3>
                <div class="item-row">
                  <span>体温</span>
                  <input
                    type="text"
                    placeholder="℃"
                    style="width: 60px; padding: 5px"
                  />
                </div>
                <div class="item-row">
                  <span>血压</span>
                  <input
                    type="text"
                    placeholder="mmHg"
                    style="width: 80px; padding: 5px"
                  />
                </div>
                <div class="item-row">
                  <span>脉搏</span>
                  <input
                    type="text"
                    placeholder="次/分"
                    style="width: 60px; padding: 5px"
                  />
                </div>
                <div class="item-row">
                  <span>过敏史</span>
                  <div>
                    <label style="margin-right: 10px"
                      ><input type="radio" name="allergy" /> 无</label
                    >
                    <label
                      ><input type="radio" name="allergy" checked /> 有</label
                    >
                  </div>
                </div>
                <div class="item-row" id="allergy-detail">
                  <span></span>
                  <input
                    type="text"
                    value="青霉素过敏"
                    style="width: 150px; padding: 5px"
                  />
                </div>
                <!-- 新增: 标准化评估量表 -->
                <button
                  class="btn secondary"
                  style="margin-top: 10px"
                  onclick="showPopup('assessment-popup')"
                >
                  使用标准评估量表
                </button>
              </div>

              <div class="card">
                <h3>处方核对</h3>
                <div class="item-row">
                  <span>药品名称</span>
                  <span>头孢曲松 1g</span>
                </div>
                <div class="item-row">
                  <span>稀释液</span>
                  <span>0.9%氯化钠 100ml</span>
                </div>
                <div class="item-row">
                  <span>用法用量</span>
                  <span>静脉滴注，30分钟完成</span>
                </div>
                <div style="margin-top: 10px">
                  <input type="checkbox" id="prescription-confirm" />
                  <label for="prescription-confirm">已核对药品信息</label>
                </div>
                <div style="margin-top: 10px">
                  <input type="checkbox" id="drug-inspect" />
                  <label for="drug-inspect">药品外观正常，无变质</label>
                </div>
              </div>

              <!-- 新增: 远程医生咨询入口 -->
              <div class="card">
                <h3>评估结论</h3>
                <select
                  style="
                    width: 100%;
                    padding: 8px;
                    margin: 10px 0;
                    border-radius: 4px;
                    border: 1px solid #ddd;
                  "
                >
                  <option>符合服务条件，可以进行服务</option>
                  <option>需调整服务方案</option>
                  <option>不符合服务条件，建议就医</option>
                </select>
                <button
                  class="btn danger"
                  onclick="showPopup('emergency-popup')"
                >
                  异常情况求助
                </button>
                <button
                  class="btn secondary"
                  onclick="showPopup('doctor-popup')"
                >
                  远程医生咨询
                </button>
              </div>

              <button class="btn success" onclick="showScreen(4)">
                评估完成，确认服务
              </button>
              <button class="btn secondary" onclick="showScreen(2)">
                返回
              </button>
            </div>

            <!-- 新增: 标准评估量表弹窗 -->
            <div class="overlay" id="assessment-overlay"></div>
            <div class="popup" id="assessment-popup">
              <h3>临床评估量表</h3>
              <div class="item-row">
                <span>疼痛评分(0-10)</span>
                <input
                  type="number"
                  min="0"
                  max="10"
                  value="0"
                  style="width: 60px; padding: 5px"
                />
              </div>
              <div class="item-row">
                <span>Glasgow评分</span>
                <input
                  type="number"
                  min="3"
                  max="15"
                  value="15"
                  style="width: 60px; padding: 5px"
                />
              </div>
              <div class="item-row">
                <span>跌倒风险评估</span>
                <select style="padding: 5px">
                  <option>低风险</option>
                  <option>中等风险</option>
                  <option>高风险</option>
                </select>
              </div>
              <button class="btn" onclick="hidePopup('assessment-popup')">
                保存评估
              </button>
              <button
                class="btn secondary"
                onclick="hidePopup('assessment-popup')"
              >
                取消
              </button>
            </div>

            <!-- 新增: 紧急情况求助弹窗 -->
            <div class="overlay" id="emergency-overlay"></div>
            <div class="popup" id="emergency-popup">
              <h3 style="color: #ff5252">紧急情况求助</h3>
              <div class="item-row">
                <span>紧急程度</span>
                <select style="padding: 5px">
                  <option>一般</option>
                  <option>紧急</option>
                  <option>危急</option>
                </select>
              </div>
              <div class="item-row">
                <span>异常情况</span>
                <textarea style="width: 100%; padding: 5px"></textarea>
              </div>
              <button class="btn danger" onclick="hidePopup('emergency-popup')">
                呼叫120
              </button>
              <button
                class="btn warning"
                onclick="hidePopup('emergency-popup')"
              >
                联系医生
              </button>
              <button
                class="btn secondary"
                onclick="hidePopup('emergency-popup')"
              >
                取消
              </button>
            </div>

            <!-- 新增: 远程医生咨询弹窗 -->
            <div class="overlay" id="doctor-overlay"></div>
            <div class="popup" id="doctor-popup">
              <h3>远程医生咨询</h3>
              <div class="card" style="margin: 10px 0">
                <div class="flex">
                  <div class="avatar">医生</div>
                  <div>
                    <div>王医生 | 内科</div>
                    <div>xx医院</div>
                  </div>
                </div>
              </div>
              <div class="item-row">
                <span>咨询问题</span>
                <textarea style="width: 100%; padding: 5px"></textarea>
              </div>
              <div class="item-row">
                <span>图片上传</span>
                <button
                  style="
                    padding: 5px;
                    background: #f0f0f0;
                    border: none;
                    border-radius: 4px;
                  "
                >
                  上传图片
                </button>
              </div>
              <button class="btn" onclick="hidePopup('doctor-popup')">
                开始视频咨询
              </button>
              <button class="btn secondary" onclick="hidePopup('doctor-popup')">
                发送文字咨询
              </button>
              <button class="btn secondary" onclick="hidePopup('doctor-popup')">
                取消
              </button>
            </div>
          </div>
        </div>

        <!-- 界面5: 确认订单 (优化版) -->
        <div class="screen-wrapper" id="screen5">
          <div class="screen-title">界面5: 确认订单</div>
          <div class="screen">
            <div class="header">
              <div class="back" onclick="showScreen(3)">←</div>
              <span>确认订单</span>
            </div>
            <div class="content">
              <div class="card">
                <h3>服务项目</h3>
                <div class="item-row">
                  <span><input type="checkbox" checked /> 静脉输液</span>
                  <span>¥70</span>
                </div>
                <div class="item-row">
                  <span><input type="checkbox" checked /> 上门服务费</span>
                  <span>¥50</span>
                </div>
                <!-- 新增: 推荐附加服务 -->
                <div
                  style="
                    margin-top: 10px;
                    border-top: 1px dashed #ddd;
                    padding-top: 10px;
                  "
                >
                  <h4>推荐服务</h4>
                  <div class="item-row">
                    <span><input type="checkbox" /> 体温监测(3天)</span>
                    <span>¥30</span>
                  </div>
                  <div class="item-row">
                    <span><input type="checkbox" /> 健康咨询(15分钟)</span>
                    <span>¥20</span>
                  </div>
                </div>
              </div>

              <div class="card">
                <h3>费用合计</h3>
                <div class="item-row" style="font-weight: bold">
                  <span>总金额</span>
                  <span>¥120</span>
                </div>
                <!-- 新增: 支付方式 -->
                <div class="item-row">
                  <span>支付方式</span>
                  <select style="padding: 5px">
                    <option>全额支付</option>
                    <option>医保支付</option>
                    <option>第三方支付</option>
                  </select>
                </div>
              </div>

              <div class="card">
                <h3>服务备注</h3>
                <textarea
                  placeholder="请输入服务注意事项或其他需要说明的内容..."
                  style="
                    width: 100%;
                    padding: 8px;
                    border-radius: 4px;
                    border: 1px solid #ddd;
                    height: 80px;
                  "
                ></textarea>
              </div>

              <!-- 新增: 服务知情同意 -->
              <div class="card">
                <h3>服务知情同意</h3>
                <div style="margin: 10px 0">
                  <input type="checkbox" id="consent-check" />
                  <label for="consent-check"
                    >患者已阅读并同意<a
                      href="#"
                      style="color: #4d7cfe"
                      onclick="showPopup('terms-popup')"
                      >《服务条款》</a
                    >和<a
                      href="#"
                      style="color: #4d7cfe"
                      onclick="showPopup('privacy-popup')"
                      >《隐私政策》</a
                    ></label
                  >
                </div>
                <div
                  style="
                    text-align: center;
                    margin: 15px 0;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                    padding: 10px;
                  "
                >
                  患者签名区域
                </div>
              </div>

              <button class="btn success" onclick="showScreen(5)">
                确认订单
              </button>
              <button class="btn secondary" onclick="showScreen(3)">
                返回修改
              </button>
            </div>

            <!-- 新增: 服务条款弹窗 -->
            <div class="overlay" id="terms-overlay"></div>
            <div class="popup" id="terms-popup">
              <h3>服务条款</h3>
              <div
                style="
                  height: 200px;
                  overflow-y: auto;
                  border: 1px solid #ddd;
                  padding: 10px;
                  margin: 10px 0;
                  font-size: 12px;
                "
              >
                <h4>一、服务说明</h4>
                <p>
                  本服务由星空之城月子科技提供，包括但不限于上门医疗护理服务。
                </p>
                <h4>二、服务规范</h4>
                <p>
                  护士将按照医嘱和护理规范提供专业服务，患者需配合完成相关操作。
                </p>
                <h4>三、责任限制</h4>
                <p>
                  因患者个人体质差异可能导致治疗效果存在差异，本公司不对治疗效果作出保证。
                </p>
                <h4>四、服务取消</h4>
                <p>如需取消服务，请提前2小时通知，否则可能产生相应费用。</p>
              </div>
              <button class="btn" onclick="hidePopup('terms-popup')">
                我已阅读并同意
              </button>
            </div>

            <!-- 新增: 隐私政策弹窗 -->
            <div class="overlay" id="privacy-overlay"></div>
            <div class="popup" id="privacy-popup">
              <h3>隐私政策</h3>
              <div
                style="
                  height: 200px;
                  overflow-y: auto;
                  border: 1px solid #ddd;
                  padding: 10px;
                  margin: 10px 0;
                  font-size: 12px;
                "
              >
                <h4>一、信息收集</h4>
                <p>
                  我们将收集您的基本信息、健康状况等相关数据，用于提供医疗服务。
                </p>
                <h4>二、信息使用</h4>
                <p>
                  您的信息将用于服务提供、质量改进和必要的医疗数据统计分析。
                </p>
                <h4>三、信息保护</h4>
                <p>
                  我们将采取严格措施保护您的个人信息和隐私，未经授权不会向第三方披露您的信息。
                </p>
              </div>
              <button class="btn" onclick="hidePopup('privacy-popup')">
                我已阅读并同意
              </button>
            </div>
          </div>
        </div>

        <!-- 界面6: 服务操作记录 (优化版) -->
        <div class="screen-wrapper" id="screen6">
          <div class="screen-title">界面6: 服务操作记录</div>
          <div class="screen">
            <div class="header">
              <div class="back" onclick="showScreen(4)">←</div>
              <span>服务记录</span>
            </div>
            <div class="content">
              <div class="card">
                <h3>操作流程</h3>
                <div class="item-row">
                  <span><input type="checkbox" checked /> 1. 核对患者信息</span>
                  <span>14:30</span>
                </div>
                <div class="item-row">
                  <span
                    ><input type="checkbox" checked /> 2. 准备药物和设备</span
                  >
                  <span>14:35</span>
                </div>
                <div class="item-row">
                  <span><input type="checkbox" checked /> 3. 告知注意事项</span>
                  <span>14:38</span>
                </div>
                <div class="item-row">
                  <span><input type="checkbox" /> 4. 静脉穿刺</span>
                  <span></span>
                </div>
                <div class="item-row">
                  <span><input type="checkbox" /> 5. 输液监测</span>
                  <span></span>
                </div>
                <div class="item-row">
                  <span><input type="checkbox" /> 6. 完成输液，拔针</span>
                  <span></span>
                </div>
                <div class="item-row">
                  <span><input type="checkbox" /> 7. 健康指导</span>
                  <span></span>
                </div>
                <!-- 新增: 标准操作规范提示 -->
                <button
                  class="btn secondary"
                  style="margin-top: 10px"
                  onclick="showPopup('sop-popup')"
                >
                  查看标准操作规范
                </button>
              </div>

              <div class="card">
                <h3>照片记录</h3>
                <div
                  style="
                    display: flex;
                    flex-wrap: wrap;
                    justify-content: space-between;
                    margin-top: 10px;
                  "
                >
                  <div
                    style="
                      width: 48%;
                      height: 80px;
                      background-color: #eee;
                      display: flex;
                      align-items: center;
                      justify-content: center;
                      margin-bottom: 10px;
                    "
                  >
                    <span>穿刺部位</span>
                  </div>
                  <div
                    style="
                      width: 48%;
                      height: 80px;
                      background-color: #eee;
                      display: flex;
                      align-items: center;
                      justify-content: center;
                      margin-bottom: 10px;
                    "
                  >
                    <span>+ 添加</span>
                  </div>
                </div>
                <!-- 新增: 语音记录 -->
                <button class="btn secondary" style="margin-top: 5px">
                  <span
                    style="
                      display: flex;
                      align-items: center;
                      justify-content: center;
                    "
                  >
                    <svg
                      viewBox="0 0 24 24"
                      width="16"
                      height="16"
                      style="margin-right: 5px"
                    >
                      <path
                        fill="currentColor"
                        d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"
                      ></path>
                    </svg>
                    语音记录
                  </span>
                </button>
                <button class="btn secondary" style="margin-top: 5px">
                  <span
                    style="
                      display: flex;
                      align-items: center;
                      justify-content: center;
                    "
                  >
                    <svg
                      viewBox="0 0 24 24"
                      width="16"
                      height="16"
                      style="margin-right: 5px"
                    >
                      <path
                        fill="currentColor"
                        d="M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z"
                      ></path>
                    </svg>
                    视频记录
                  </span>
                </button>
              </div>

              <!-- 新增: 耗材记录 -->
              <div class="card">
                <h3>耗材记录</h3>
                <div class="item-row">
                  <span>输液器</span>
                  <span>1个</span>
                </div>
                <div class="item-row">
                  <span>针头</span>
                  <span>1个</span>
                </div>
                <div class="item-row">
                  <span>胶带</span>
                  <span>1卷</span>
                </div>
                <div class="item-row">
                  <span>酒精棉球</span>
                  <span>4个</span>
                </div>
                <button
                  class="btn secondary"
                  style="margin-top: 10px"
                  onclick="showPopup('waste-popup')"
                >
                  医疗废物处理
                </button>
              </div>

              <div class="card">
                <h3>异常情况记录</h3>
                <textarea
                  placeholder="请记录服务过程中遇到的任何异常情况..."
                  style="
                    width: 100%;
                    padding: 8px;
                    border-radius: 4px;
                    border: 1px solid #ddd;
                    height: 80px;
                  "
                ></textarea>
              </div>

              <button class="btn success" onclick="showScreen(6)">
                服务完成
              </button>
              <button class="btn secondary" onclick="showScreen(4)">
                返回
              </button>
            </div>

            <!-- 新增: 标准操作规范弹窗 -->
            <div class="overlay" id="sop-overlay"></div>
            <div class="popup" id="sop-popup">
              <h3>输液标准操作规范</h3>
              <div
                style="
                  height: 200px;
                  overflow-y: auto;
                  border: 1px solid #ddd;
                  padding: 10px;
                  margin: 10px 0;
                  font-size: 12px;
                "
              >
                <h4>1. 准备阶段</h4>
                <p>
                  - 核对患者信息和医嘱<br />- 洗手和消毒<br />- 准备所需物品
                </p>
                <h4>2. 穿刺阶段</h4>
                <p>
                  - 选择合适的静脉<br />- 使用75%酒精消毒皮肤<br />-
                  合适角度进行穿刺
                </p>
                <h4>3. 输液监测</h4>
                <p>
                  - 确认液体滴速<br />- 定期检查穿刺部位<br />- 观察患者反应
                </p>
                <h4>4. 结束阶段</h4>
                <p>
                  - 拔除针头前先关闭流速<br />- 用消毒棉压迫穿刺点<br />-
                  废物分类处理
                </p>
              </div>
              <button class="btn" onclick="hidePopup('sop-popup')">
                我已了解
              </button>
            </div>

            <!-- 新增: 医疗废物处理弹窗 -->
            <div class="overlay" id="waste-overlay"></div>
            <div class="popup" id="waste-popup">
              <h3>医疗废物处理确认</h3>
              <div style="margin: 10px 0">
                <div><input type="checkbox" /> 已将使用过的针头放入利器盒</div>
                <div>
                  <input type="checkbox" />
                  已将输液器等医疗废物放入黄色医疗废物袋
                </div>
                <div><input type="checkbox" /> 已将生活垃圾分类处理</div>
                <div><input type="checkbox" /> 已将医疗废物袋密封</div>
                <div><input type="checkbox" /> 已标记医疗废物来源和日期</div>
              </div>
              <div style="margin: 10px 0">
                <div>废物去向：</div>
                <select style="width: 100%; padding: 5px; margin-top: 5px">
                  <option>带回机构统一处理</option>
                  <option>交由社区医疗点处理</option>
                  <option>其他方式</option>
                </select>
              </div>
              <button class="btn" onclick="hidePopup('waste-popup')">
                确认已处理
              </button>
              <button class="btn secondary" onclick="hidePopup('waste-popup')">
                取消
              </button>
            </div>
          </div>
        </div>

        <!-- 界面7: 确认服务 (优化版) -->
        <div class="screen-wrapper" id="screen7">
          <div class="screen-title">界面7: 确认服务</div>
          <div class="screen">
            <div class="header">
              <div class="back" onclick="showScreen(5)">←</div>
              <span>服务完成</span>
            </div>
            <div class="content">
              <div class="card">
                <h3>服务小结</h3>
                <div class="item-row">
                  <span>服务项目</span>
                  <span>静脉输液</span>
                </div>
                <div class="item-row">
                  <span>开始时间</span>
                  <span>14:30</span>
                </div>
                <div class="item-row">
                  <span>结束时间</span>
                  <span>15:15</span>
                </div>
                <div class="item-row">
                  <span>服务费用</span>
                  <span>¥120</span>
                </div>
              </div>

              <div class="card">
                <h3>小票打印</h3>
                <div
                  style="
                    border: 1px dashed #ddd;
                    padding: 15px;
                    border-radius: 5px;
                  "
                >
                  <div
                    style="
                      text-align: center;
                      margin-bottom: 10px;
                      font-weight: bold;
                    "
                  >
                    星空之城月子科技
                  </div>
                  <div class="item-row">
                    <span>服务单号</span>
                    <span>SN12345678</span>
                  </div>
                  <div class="item-row">
                    <span>日期</span>
                    <span>2023-11-15</span>
                  </div>
                  <div class="item-row">
                    <span>患者</span>
                    <span>张女士</span>
                  </div>
                  <div class="item-row">
                    <span>项目</span>
                    <span>静脉输液</span>
                  </div>
                  <div class="item-row">
                    <span>金额</span>
                    <span>¥120</span>
                  </div>
                  <div class="item-row">
                    <span>护士</span>
                    <span>王护士</span>
                  </div>
                </div>
              </div>

              <!-- 新增: 后续护理指导 -->
              <div class="card">
                <h3>后续护理指导</h3>
                <div style="margin: 10px 0">
                  <p>1. 穿刺部位保持干燥，24小时内避免碰水</p>
                  <p>2. 如有红肿、疼痛等不适，请及时联系</p>
                  <p>3. 按时服用医生处方的口服药物</p>
                  <p>4. 多休息，多饮水，清淡饮食</p>
                </div>
                <button
                  class="btn secondary"
                  onclick="showToast('已发送护理指导到患者手机')"
                >
                  发送至患者手机
                </button>
              </div>

              <!-- 新增: 满意度调查 -->
              <div class="card">
                <h3>服务满意度</h3>
                <div style="text-align: center; margin: 10px 0">
                  <span style="font-size: 24px">★★★★★</span>
                </div>
                <textarea
                  placeholder="请患者填写对本次服务的意见或建议..."
                  style="
                    width: 100%;
                    padding: 8px;
                    border-radius: 4px;
                    border: 1px solid #ddd;
                    height: 60px;
                  "
                ></textarea>
              </div>

              <!-- 新增: 预约下次服务 -->
              <div class="card">
                <h3>预约下次服务</h3>
                <div style="display: flex; gap: 10px; margin: 10px 0">
                  <button class="btn secondary" style="margin: 0">
                    换药服务
                  </button>
                  <button class="btn secondary" style="margin: 0">
                    输液服务
                  </button>
                  <button class="btn secondary" style="margin: 0">
                    检查服务
                  </button>
                </div>
              </div>

              <div style="display: flex; gap: 10px">
                <div style="flex: 1">
                  <button class="btn success" onclick="showScreen(7)">
                    确认完成
                  </button>
                </div>
                <div style="flex: 1">
                  <button
                    class="btn secondary"
                    onclick="showToast('已保存电子小票')"
                  >
                    保存小票
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 界面8: 发起收款 (优化版) -->
        <div class="screen-wrapper" id="screen8">
          <div class="screen-title">界面8: 发起收款</div>
          <div class="screen">
            <div class="header">
              <div class="back" onclick="showScreen(6)">←</div>
              <span>收款</span>
            </div>
            <div class="content">
              <div style="text-align: center; margin: 20px 0">
                <h2>¥120.00</h2>
                <p>服务费用总计</p>
              </div>

              <div class="card">
                <h3>支付方式</h3>
                <div class="item-row">
                  <span
                    ><input type="radio" name="payment" checked />
                    微信支付</span
                  >
                  <span>推荐</span>
                </div>
                <div class="item-row">
                  <span><input type="radio" name="payment" /> 支付宝</span>
                  <span></span>
                </div>
                <div class="item-row">
                  <span><input type="radio" name="payment" /> 医保支付</span>
                  <span></span>
                </div>
                <div class="item-row">
                  <span><input type="radio" name="payment" /> 现金支付</span>
                  <span></span>
                </div>
                <!-- 新增: 家庭成员代付 -->
                <div class="item-row">
                  <span
                    ><input type="radio" name="payment" /> 家庭成员代付</span
                  >
                  <span
                    ><button
                      class="btn secondary"
                      style="margin: 0; padding: 2px 8px; font-size: 12px"
                    >
                      选择
                    </button></span
                  >
                </div>
              </div>

              <!-- 新增: 优惠券 -->
              <div class="card">
                <h3>优惠信息</h3>
                <div class="item-row">
                  <span>可用优惠券</span>
                  <span
                    ><button
                      class="btn secondary"
                      style="margin: 0; padding: 2px 8px; font-size: 12px"
                    >
                      选择 (3)
                    </button></span
                  >
                </div>
                <div class="item-row">
                  <span>会员积分</span>
                  <span>可用300积分抵扣¥3.00</span>
                </div>
              </div>

              <div class="card">
                <h3>收款码</h3>
                <div style="text-align: center; margin: 15px 0">
                  <div
                    style="
                      width: 150px;
                      height: 150px;
                      background-color: #eee;
                      margin: 0 auto;
                      display: flex;
                      align-items: center;
                      justify-content: center;
                    "
                  >
                    二维码图片
                  </div>
                  <p>请患者扫码支付</p>
                </div>
              </div>

              <div class="card">
                <h3>收款状态</h3>
                <div
                  style="
                    text-align: center;
                    padding: 15px 0;
                    color: #ff5252;
                    font-weight: bold;
                  "
                >
                  等待支付...
                </div>
              </div>

              <!-- 新增: 发票申请 -->
              <div class="card">
                <h3>发票申请</h3>
                <div class="item-row">
                  <span>需要发票</span>
                  <span><input type="checkbox" /></span>
                </div>
                <button class="btn secondary" style="margin-top: 5px">
                  填写发票信息
                </button>
              </div>

              <!-- 新增: 支付失败处理 -->
              <div
                class="card"
                style="
                  background-color: #fff1f0;
                  border-left: 3px solid #ff4d4f;
                  display: none;
                "
                id="payment-error"
              >
                <h3>支付异常</h3>
                <p>支付未完成，请重试或更换支付方式</p>
                <button class="btn danger" style="margin-top: 5px">
                  重新生成支付码
                </button>
              </div>

              <button class="btn success" onclick="completeProcess()">
                确认已收款
              </button>
              <button
                class="btn secondary"
                onclick="document.getElementById('payment-error').style.display='block'"
              >
                模拟支付失败
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 新增: 通话弹窗 -->
    <div class="overlay" id="call-overlay"></div>
    <div class="popup" id="call-popup">
      <h3>联系患者</h3>
      <div style="font-size: 20px; text-align: center; margin: 20px 0">
        <span>张女士: 138****5678</span>
      </div>
      <div style="display: flex; justify-content: space-around; margin: 20px 0">
        <button
          class="btn"
          style="flex: 1; margin: 0 5px"
          onclick="hidePopup('call-popup'); showToast('正在拨打电话...')"
        >
          拨打电话
        </button>
        <button
          class="btn"
          style="flex: 1; margin: 0 5px"
          onclick="hidePopup('call-popup'); showToast('短信发送成功')"
        >
          发送短信
        </button>
      </div>
      <button class="btn secondary" onclick="hidePopup('call-popup')">
        取消
      </button>
    </div>

    <!-- 新增: Toast提示 -->
    <div
      id="toast"
      style="
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 10px 20px;
        border-radius: 4px;
        display: none;
      "
    >
      提示信息
    </div>

    <script>
      // 当前页面索引
      let currentScreenIndex = 0;

      // 选择订单
      function selectOrder(orderElement) {
        // 移除所有订单的选中样式
        document.querySelectorAll(".order-card").forEach((card) => {
          card.style.border = "none";
        });

        // 添加选中样式
        orderElement.style.border = "2px solid #4D7CFE";

        // 如果点击的是第一个订单，2秒后自动进入详情页
        if (orderElement.id === "order1") {
          setTimeout(() => {
            showScreen(1);
          }, 500);
        }
      }

      // 显示指定页面
      function showScreen(index) {
        // 隐藏所有页面
        document.querySelectorAll(".screen-wrapper").forEach((screen) => {
          screen.classList.remove("active");
        });

        // 显示指定页面
        document.querySelector(`#screen${index + 1}`).classList.add("active");

        // 更新当前页面索引
        currentScreenIndex = index;

        // 更新进度条和步骤状态
        updateProgress();
      }

      // 更新进度条和步骤状态
      function updateProgress() {
        // 清除所有步骤的状态
        document.querySelectorAll(".process-step").forEach((step, idx) => {
          step.classList.remove("active", "completed");
          if (idx < currentScreenIndex) {
            step.classList.add("completed");
          } else if (idx === currentScreenIndex) {
            step.classList.add("active");
          }
        });

        // 计算进度条宽度
        const progressWidth = currentScreenIndex * (100 / 7); // 7是步骤间隔数
        document.getElementById("progressLine").style.width =
          progressWidth + "%";
      }

      // 显示弹窗
      function showPopup(popupId) {
        document.getElementById(popupId).style.display = "block";
        document.getElementById(
          popupId.replace("-popup", "-overlay")
        ).style.display = "block";
      }

      // 隐藏弹窗
      function hidePopup(popupId) {
        document.getElementById(popupId).style.display = "none";
        document.getElementById(
          popupId.replace("-popup", "-overlay")
        ).style.display = "none";
      }

      // 显示Toast提示
      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.style.display = "block";

        setTimeout(() => {
          toast.style.display = "none";
        }, 2000);
      }

      // 完成整个流程
      function completeProcess() {
        showToast("服务已完成，感谢您的使用！");
        setTimeout(() => {
          showScreen(0);
        }, 2000);
      }

      // 初始化显示第一个页面
      showScreen(0);
    </script>
  </body>
</html>
